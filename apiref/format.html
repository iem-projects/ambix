<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>libambix: The ambix format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libambix
   </div>
   <div id="projectbrief">the AMBIsonics eXchange library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">The ambix format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The ambisonics channel layout for ambix-files is <a class="el" href="format.html#format_norm">SN3D</a>/<a class="el" href="format.html#format_acn">ACN </a> (3D, seminormalized, <em>Ambisonic Channel Numbers</em>), henceforth called "standard layout".</p>
<p>Files in <a class="el" href="ambix_8h.html#aa079d38c1d269ac5dfbe4dd4251b3e42abb44830701a07dc50814f69ec74050d5">AMBIX_BASIC</a> format always store the data in the standard layout. Files in <a class="el" href="ambix_8h.html#aa079d38c1d269ac5dfbe4dd4251b3e42abdb142f028c2b82558a73552d8f7f59d">AMBIX_EXTENDED</a> format can store the data in any layout they prefer, but have to provide an adapator matrix \(M\) that can be used to convert the channels layout stored within the file to the standard layout, according to the formula \(\vec{b}_{standardlayout}=M_{adaptor}*\vec{b}_{filelayout}\).</p>
<p>E.g. if the channels are stored in the traditional <em>B-format</em> (3D), the following adaptor matrix has to be used:</p>
<p>\(M_{B\rightarrow ambix}=\begin{pmatrix}\sqrt{2}&amp;0&amp;0&amp;0\\0&amp;0&amp;0&amp;-1\\0&amp;1&amp;0&amp;0\\0&amp;0&amp;-1&amp;0\end{pmatrix}\)</p>
<h1><a class="anchor" id="format_bugfix"></a>
Bug-fixes for the format-specification</h1>
<p>The original <a href="http://ambisonics.iem.at/xchange/fileformat/2011_nachbarzottersontacchideleflie_ambix.pdf">format proposal</a> had a number of flaws and bugs that have been discovered during the implenentation of <em>libambix</em>. Consequently, these flaws and bugs have been fixed.</p>
<h2><a class="anchor" id="format_bugfix_UUID"></a>
UUID-chunk</h2>
<p>The original format proposal defined a UUID <b>49454d2e-4154-2f41-4d42-49582f584d4c</b>, which is equivalent to the literal "IEM.AT/AMBIX/XML" (the UUID is an ASCII-representation of this string). Unfortunately this does not take into account, that while UUIDs can be <em>random</em>, certain bits are reserved (e.g. indicating the UUID variant). The originally suggested UUID is - according to it's reserved bits - a v2 variant (DCE Security), though in reality it is not. This makes name clashes probable and counteracts the idea of using UUIDs. This UUID should therefore be deprecated.</p>
<p>Therefore, it is suggested to use URL based UUID of the v5 variant (SHA-1 based), with the URLs following the scheme <a href="http://ambisonics.iem.at/xchange/format/1.0">http://ambisonics.iem.at/xchange/format/1.0</a> , where the last element of the URL denotes the ambix specification version the given chunk adheres to. This allows for easy and consistent adding of new UUIDs, if the format ever needs to be extended.</p>
<p>The URL <a href="http://ambisonics.iem.at/xchange/format/1.0">http://ambisonics.iem.at/xchange/format/1.0</a> translates to the UUID <b>1ad318c3-00e5-5576-be2d-0dca2460bc89</b>.</p>
<p>For compatibility reasons, libambix will be able to read both the original (deprecated) and the new UUID. However, it will only write the new UUID to newly created ambix files.</p>
<h2><a class="anchor" id="format_bugfix_sampletypes"></a>
Valid sample types</h2>
<p>The original format proposal enumerates the valid sample (audio data) types, as int16, int24, int32 and float32. This seems to be an unnecessary restriction on the CAF-format. All sample types valid in CAF-files should be valid in ambix files as well.</p>
<h2><a class="anchor" id="format_bugfix_rowcols"></a>
Type of rows &amp; columns in the adaptor matrix</h2>
<p>The original format proposal shows the adaptor matrix as a linear array of float32 values, with the first element being the number of rows in the matrix and the second element being the number of columns. The remaining values form the actual matrix data in the order a[0,0], a[0,1]...a[L,C]. Since both rows and columns can only be positive integer values, this has been changed, so the first two values are of the type int32.</p>
<h2><a class="anchor" id="format_bugfix_extrachannels"></a>
Extra (non-ambisonics) channels</h2>
<p>The original format proposal speaks only of full ambisonics sets (in the case of the "BASIC" format, all audio channels in the CAF-file must form exactly a full ambisonics set; in the case of the "EXTENDED" format, all audio channels in the CAF-file multiplied by the adaptor matrix must form a full ambisonics set). When implementing libambix, this was interpreted to allow room for "extra" (non-ambisonics) channels in the "EXTENDED" format: If a file holds (C+X) audio channels (with both C and X being positive integers), the first C channels are converted into a full ambisonics set by multiplying it with the [L*C] adaptor matrix. The remaining X channels are provided "as-is", and can be used to store extra data (like click-tracks,...)</p>
<h1><a class="anchor" id="format_glossary"></a>
Format Glossary</h1>
<h2><a class="anchor" id="format_norm"></a>
Normalisation</h2>
<p>There are a number of different ways how to <em>normalize</em> the Ambisonics channels (that is: how they are weighted relative to each other). The default layout assumes <em>Schmidt semi-normalized</em> spherical harmonics.</p>
<h2><a class="anchor" id="format_acn"></a>
Ambisonics Channel Number</h2>
<p>The channel ordering is standardized using the following formula (with \(l\) being the <em>degree</em> and \(m\) being the <em>order</em> of the spherical harmonic).</p>
<p>\(ACN = l * ( l + 1 ) + m\) </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
